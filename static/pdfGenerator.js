document.addEventListener('DOMContentLoaded', function() {
    const downloadPdfButton = document.getElementById('downloadPdfButton');
    
    if (downloadPdfButton) {
        downloadPdfButton.addEventListener('click', generatePDF);
    }

    function generatePDF() {
        const jobDescription = document.getElementById('jobDescription').value;
        if (!jobDescription.trim()) {
            alert('Please enter a job description first.');
            return;
        }

        // Create a hidden element for PDF content
        const element = document.createElement('div');
        element.innerHTML = `
            <h2 style="color: #1a365d; font-size: 24px; margin-bottom: 20px;">Job Description</h2>
            <div style="white-space: pre-wrap; font-family: Arial, sans-serif; line-height: 1.6;">
                ${jobDescription}
            </div>
            <div style="margin-top: 20px; font-size: 12px; color: #666;">
                Generated by ResumeIQ on ${new Date().toLocaleDateString()}
            </div>
        `;

        // Configure PDF options
        const opt = {
            margin: 1,
            filename: 'job_description.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
        };

        // Generate PDF
        html2pdf().set(opt).from(element).save()
            .catch(err => {
                console.error('PDF generation failed:', err);
                alert('Failed to generate PDF. Please try again.');
            });
    }
});